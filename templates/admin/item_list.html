{% extends "base.html" %}
{% block content %}

<div class="main" style="flex-direction: column; align-items: flex-start; width:100%;">

    <!-- ðŸ”¹ SEARCH & FILTER BAR (SAME AS DASHBOARD) -->
    <div class="filter-bar">

        <form method="GET" action="/admin/item-list" class="filter-form">
            <input type="text"
                   name="search"
                   placeholder="Search product..."
                   value="{{ request.args.get('search', '') }}">
            <button type="submit">Search</button>
        </form>

        <form method="GET" action="/admin/item-list" class="filter-form">
            <select name="category">
                <option value="">All Categories</option>
                {% for cat in categories %}
                <option value="{{ cat.category }}"
                    {% if request.args.get('category') == cat.category %}selected{% endif %}>
                    {{ cat.category }}
                </option>
                {% endfor %}
            </select>
            <button type="submit">Filter</button>
        </form>

    </div>

    <!-- ðŸ”¹ PRODUCTS CARD -->
    <div class="table-container" style="max-width:1100px; width:100%; margin-top:20px;">

        <h1 style="margin-bottom: 15px;">All Products</h1>

        <a href="/admin/add-item" class="add-product-btn" style="margin-bottom:15px;">
                + Add New Product
           </a>

        <table class="product-table">
            <tr>
                <th>ID</th>
                <th>Image</th>
                <th>Name</th>
                <th>Category</th>
                <th>Price</th>
                <th>View</th>
                <th>Update</th>
                <th>Delete</th>
            </tr>

            {% for product in products %}
            <tr>
                <td>{{ product.product_id }}</td>
                <td>
                    <img src="{{ url_for('static',
                        filename='uploads/product_images/' ~ product.image) }}">
                </td>
                <td>{{ product.name }}</td>
                <td>{{ product.category }}</td>
                <td>â‚¹{{ product.price }}</td>
                <td><a href="/admin/view-item/{{ product.product_id }}" class="btn-back">View</a></td>
                <td><a href="/admin/update-item/{{ product.product_id }}" class="btn-back">Update</a></td>
                <td><a href="/admin/delete-item/{{ product.product_id }}" class="btn-back">Delete</a></td>
            </tr>
            {% endfor %}
        </table>

        <div style="margin-top:20px;">
            <a href="/admin-dashboard" class="btn-back">â¬… Back to Dashboard</a>
        </div>

    </div>
</div>

{% endblock %}