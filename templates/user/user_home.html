{% extends "base.html" %}
{% block content %}

<div class="main" style="flex-direction: column; align-items: flex-start; width:100%;">

    <h2 style="color:#1d1b1b; margin-bottom:15px;">
        Welcome, {{ user_name }}!
    </h2>

    <!-- ðŸ” SEARCH & FILTER -->
    <div class="filter-bar">

        <form method="GET" action="/user-dashboard" class="filter-form">
            <input type="text" name="search"
                   placeholder="Search product..."
                   value="{{ request.args.get('search', '') }}">
            <button type="submit">Search</button>
        </form>

        <form method="GET" action="/user-dashboard" class="filter-form">
            <select name="category">
                <option value="">All Categories</option>
                {% for cat in categories %}
                <option value="{{ cat.category }}"
                    {% if request.args.get('category') == cat.category %}selected{% endif %}>
                    {{ cat.category }}
                </option>
                {% endfor %}
            </select>
            <button type="submit">Filter</button>
        </form>

    </div>

    <!-- ðŸ› PRODUCTS -->
    <div style="display:flex; flex-wrap:wrap; gap:20px; margin-top:20px;">

        {% for product in products %}
        <div class="card" style="width:300px; height: 270px; padding:20px; text-align:center;">

            <img src="{{ url_for('static',
                filename='uploads/product_images/' ~ product.image) }}"
                style="width:140px; height:100px; object-fit:contain;">

            <h3>{{ product.name }}</h3>
            <p>{{ product.category }}</p>
            <p><strong>â‚¹{{ product.price }}</strong></p>

            <a href="/user/product/{{ product.product_id }}"
               class="add-product-btn">
                View Details
            </a>

            <a href="/user/add-to-cart/{{ product.product_id }}"
               class="add-product-btn"
               style="margin-top:10px;">
                Add to cart
            </a>

        </div>
        {% endfor %}

    </div>

</div>

{% endblock %}